(()=>{"use strict";class t{static closeSiblings(t){const e=t.parentElement;e&&Array.from(e.children).forEach(e=>{if(e!==t&&e.classList.contains("menu-item-has-children")){e.classList.remove("active");const t=e.querySelector(".submenu-toggle-btn");t&&t.setAttribute("aria-expanded","false")}})}}class e{constructor(){this.menuItems=document.querySelectorAll(".menu-item-has-children")}init(){this.menuItems.forEach(t=>{this.createToggleButton(t),t.addEventListener("focusout",this.onFocusOut.bind(this)),t.addEventListener("keydown",this.onItemKeydown.bind(this))})}createToggleButton(t){const e=t.querySelector("a");if(!e)return;const n=document.createElement("button");n.className="submenu-toggle-btn",n.type="button",n.setAttribute("aria-label","サブメニューを開閉"),n.setAttribute("aria-expanded","false"),n.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.toggleMenu(t,n)}),e.after(n)}toggleMenu(e,n){e.classList.contains("active")||t.closeSiblings(e),e.classList.toggle("active");const s=e.classList.contains("active");n.setAttribute("aria-expanded",String(s))}onFocusOut(t){const e=t.currentTarget;setTimeout(()=>{if(!e.contains(document.activeElement)){e.classList.remove("active");const t=e.querySelector(".submenu-toggle-btn");t&&t.setAttribute("aria-expanded","false")}},0)}onItemKeydown(t){if("Escape"===t.key){const e=t.currentTarget;if(e.classList.contains("active")){t.stopPropagation(),e.classList.remove("active");const n=e.querySelector(".submenu-toggle-btn");n&&(n.setAttribute("aria-expanded","false"),n.focus())}}}}class n{constructor(){this.toggleButton=document.getElementById("menuToggle-button"),this.checkbox=document.getElementById("menuToggle-checkbox"),this.container=document.getElementById("primary-menu-container"),this.breakpoint=768}init(){this.toggleButton&&this.checkbox&&this.container&&(this.updateAttributes(this.checkbox.checked),this.checkbox.addEventListener("change",()=>{this.updateAttributes(this.checkbox.checked)}),this.toggleButton.addEventListener("click",()=>{this.checkbox.checked=!this.checkbox.checked,this.checkbox.dispatchEvent(new Event("change"))}))}updateAttributes(t){this.toggleButton.setAttribute("aria-expanded",String(t)),this.container.setAttribute("aria-hidden",String(!t))}}document.addEventListener("DOMContentLoaded",()=>{(new e).init(),(new n).init()})})();